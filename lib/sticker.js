/*
//══════════════════════════════════════════════════════════════════════════════════════════════════════//
//                                                                                                      //
//                                ＷＨＡＴＳＡＰＰ ＢＯＴ－ＭＤ                                             // 
//                                                                                                      // 
//                                         Ｖ：１．０                                                    // 
//                                                                                                      // 
//                                                                                                      //
//         ██████ ██    ██  ██████  ███    ██ ██    ██ ███████       ██████   ██████  ████████          //
//        ██       ██  ██  ██       ████   ██ ██    ██ ██            ██   ██ ██    ██    ██             //
//        ██        ████   ██   ███ ██ ██  ██ ██    ██ ███████ █████ ██████  ██    ██    ██             //   
//        ██         ██    ██    ██ ██  ██ ██ ██    ██      ██       ██   ██ ██    ██    ██             //  
//         ██████    ██     ██████  ██   ████  ██████  ███████       ██████   ██████     ██             //  
//                                                                                                      //
//                                                                                                      //
//                                                                                                      //
//                                                                                                      //
//                                                                                                      //
//                                                                                                      //
//══════════════════════════════════════════════════════════════════════════════════════════════════════//

*
   * @project_name : CYGNUS-BOT
   * @author : CODERXSA
   * @youtube : https://www.youtube.com/coderxsa
   * @description : My Private build i made public for everone to use and easy hosting.
   * @version 1.0
*
   * Licensed under the  GPL-3.0 License;
* 
   * Created By CODERX.
   * © 2024 CYGNUS-BOT.
*/


//══════════════════════════════════════════════════════════════════════════════════════════════════════//

const _0x3aadee=_0x3ac5;(function(_0x51899f,_0x1b7004){const _0x36cfe8=_0x3ac5,_0xc2a5f=_0x51899f();while(!![]){try{const _0x2675e4=parseInt(_0x36cfe8(0x169))/0x1*(-parseInt(_0x36cfe8(0x17e))/0x2)+parseInt(_0x36cfe8(0x16a))/0x3*(-parseInt(_0x36cfe8(0x1a3))/0x4)+-parseInt(_0x36cfe8(0x18a))/0x5+-parseInt(_0x36cfe8(0x19b))/0x6+parseInt(_0x36cfe8(0x199))/0x7+parseInt(_0x36cfe8(0x16d))/0x8*(parseInt(_0x36cfe8(0x177))/0x9)+parseInt(_0x36cfe8(0x181))/0xa*(parseInt(_0x36cfe8(0x192))/0xb);if(_0x2675e4===_0x1b7004)break;else _0xc2a5f['push'](_0xc2a5f['shift']());}catch(_0x1ac897){_0xc2a5f['push'](_0xc2a5f['shift']());}}}(_0x3439,0x8c7ad));import{dirname}from'path';import{fileURLToPath}from'url';import*as _0x5882d4 from'fs';import*as _0x5181db from'path';import*as _0x56cb1e from'crypto';import{ffmpeg}from'./converter.js';import _0x253cb9 from'fluent-ffmpeg';import{spawn}from'child_process';import _0x2de70c from'./uploadFile.js';import _0x2e0895 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import _0x542062 from'node-webpmux';import _0x284c96 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta['url'])),tmp=_0x5181db[_0x3aadee(0x190)](__dirname,_0x3aadee(0x19d));function sticker2(_0x5ce5a5,_0x3566a8){return new Promise(async(_0x3e47ff,_0x4bfb92)=>{const _0x1e1107=_0x3ac5;try{if(_0x3566a8){let _0x454bd4=await _0x284c96(_0x3566a8);if(_0x454bd4[_0x1e1107(0x182)]!==0xc8)throw await _0x454bd4[_0x1e1107(0x175)]();_0x5ce5a5=await _0x454bd4[_0x1e1107(0x1b1)]();}let _0x171ff4=_0x5181db['join'](tmp,+new Date()+_0x1e1107(0x19f));await _0x5882d4[_0x1e1107(0x19c)][_0x1e1107(0x1a4)](_0x171ff4,_0x5ce5a5);let _0x49ad57=spawn(_0x1e1107(0x1a5),['-y','-i',_0x171ff4,_0x1e1107(0x1a1),'scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','-f',_0x1e1107(0x180),'-']);_0x49ad57['on']('error',_0x4bfb92),_0x49ad57['on'](_0x1e1107(0x173),async()=>{await _0x5882d4['promises']['unlink'](_0x171ff4);});let _0x521d2a=[];const [_0x5a8563,..._0x2d76c4]=[...module['exports'][_0x1e1107(0x18b)]['gm']?['gm']:module[_0x1e1107(0x1a7)][_0x1e1107(0x183)]?['magick']:[],_0x1e1107(0x1a9),_0x1e1107(0x1ad),'webp:-'];let _0x20ef22=spawn(_0x5a8563,_0x2d76c4);_0x20ef22['on'](_0x1e1107(0x1b0),_0x5e7540=>conn[_0x1e1107(0x19a)](m[_0x1e1107(0x1ac)],util[_0x1e1107(0x189)](_0x5e7540),m)),_0x20ef22[_0x1e1107(0x171)]['on'](_0x1e1107(0x16e),_0x446305=>_0x521d2a['push'](_0x446305)),_0x49ad57[_0x1e1107(0x171)][_0x1e1107(0x186)](_0x20ef22[_0x1e1107(0x172)]),_0x20ef22['on'](_0x1e1107(0x178),()=>{const _0x17c544=_0x1e1107;_0x3e47ff(Buffer[_0x17c544(0x1a8)](_0x521d2a));});}catch(_0x37e637){_0x4bfb92(_0x37e637);}});}async function sticker3(_0x2c24a2,_0x241801,_0xf03c9a,_0x248cb9){const _0x43bed1=_0x3aadee;_0x241801=_0x241801?_0x241801:await _0x2de70c(_0x2c24a2);let _0x4a5b60=await _0x284c96(_0x43bed1(0x1ae)+new URLSearchParams(Object[_0x43bed1(0x1aa)]({'url':_0x241801,'packname':_0xf03c9a,'author':_0x248cb9})));return await _0x4a5b60[_0x43bed1(0x1b1)]();}function _0x3ac5(_0x3b41d9,_0x5404e7){const _0x343904=_0x3439();return _0x3ac5=function(_0x3ac5ef,_0x36bc29){_0x3ac5ef=_0x3ac5ef-0x169;let _0xdaf50a=_0x343904[_0x3ac5ef];return _0xdaf50a;},_0x3ac5(_0x3b41d9,_0x5404e7);}async function sticker4(_0x52c61b,_0x60cbd0){const _0x570ec0=_0x3aadee;if(_0x60cbd0){let _0x44d16f=await _0x284c96(_0x60cbd0);if(_0x44d16f[_0x570ec0(0x182)]!==0xc8)throw await _0x44d16f[_0x570ec0(0x175)]();_0x52c61b=await _0x44d16f[_0x570ec0(0x1b1)]();}return await ffmpeg(_0x52c61b,[_0x570ec0(0x1a1),_0x570ec0(0x1a2)],_0x570ec0(0x194),_0x570ec0(0x1ab));}async function sticker5(_0x37c15d,_0x2e384b,_0x122cc4,_0x8bf8ff,_0x573209=[''],_0x31b650={}){const _0x39ae96=_0x3aadee,{Sticker:_0x1b99aa}=await import('wa-sticker-formatter'),_0x4d34c1={'type':'default','pack':_0x122cc4,'author':_0x8bf8ff,'categories':_0x573209,..._0x31b650};return new _0x1b99aa(_0x37c15d?_0x37c15d:_0x2e384b,_0x4d34c1)[_0x39ae96(0x1af)]();}function sticker6(_0x1c9361,_0x345c31){return new Promise(async(_0x48494a,_0x219cd3)=>{const _0x39c21e=_0x3ac5;if(_0x345c31){let _0x14e3e6=await _0x284c96(_0x345c31);if(_0x14e3e6[_0x39c21e(0x182)]!==0xc8)throw await _0x14e3e6[_0x39c21e(0x175)]();_0x1c9361=await _0x14e3e6['buffer']();}const _0x93c8cb=await fileTypeFromBuffer(_0x1c9361)||{'mime':_0x39c21e(0x16c),'ext':_0x39c21e(0x174)};if(_0x93c8cb['ext']=='bin')_0x219cd3(_0x1c9361);const _0x75daa5=_0x5181db[_0x39c21e(0x190)](__dirname,_0x39c21e(0x17f)+ +new Date()+'.'+_0x93c8cb[_0x39c21e(0x198)]),_0x18cd49=_0x5181db['join'](_0x75daa5+'.webp');await _0x5882d4[_0x39c21e(0x19c)][_0x39c21e(0x1a4)](_0x75daa5,_0x1c9361);let _0xe46f0d=/video/i[_0x39c21e(0x18d)](_0x93c8cb[_0x39c21e(0x193)])?_0x253cb9(_0x75daa5)[_0x39c21e(0x18f)](_0x93c8cb['ext']):_0x253cb9(_0x75daa5)['input'](_0x75daa5);_0xe46f0d['on'](_0x39c21e(0x1b0),function(_0x6ec07d){const _0x4fdf6c=_0x39c21e;console[_0x4fdf6c(0x1b0)](_0x6ec07d),_0x5882d4[_0x4fdf6c(0x19c)][_0x4fdf6c(0x17b)](_0x75daa5),_0x219cd3(_0x1c9361);})['on'](_0x39c21e(0x185),async function(){const _0x4e2790=_0x39c21e;_0x5882d4[_0x4e2790(0x19c)][_0x4e2790(0x17b)](_0x75daa5),_0x48494a(await _0x5882d4[_0x4e2790(0x19c)][_0x4e2790(0x18c)](_0x18cd49));})[_0x39c21e(0x179)]([_0x39c21e(0x195),_0x39c21e(0x19e),_0x39c21e(0x1a1),_0x39c21e(0x187)])[_0x39c21e(0x196)](_0x39c21e(0x1ab))[_0x39c21e(0x18e)](_0x18cd49);});}async function addExif(_0x1f401f,_0x3fd1c0,_0x2622da,_0x32fc46=[''],_0x3bd26b={}){const _0x5489d5=_0x3aadee,_0x374cfc=new _0x542062['Image'](),_0x22b62c=_0x56cb1e[_0x5489d5(0x191)](0x20)[_0x5489d5(0x184)](_0x5489d5(0x188)),_0x3b8b2d={'sticker-pack-id':_0x22b62c,'sticker-pack-name':_0x3fd1c0,'sticker-pack-publisher':_0x2622da,'emojis':_0x32fc46,..._0x3bd26b};let _0x599ba1=Buffer[_0x5489d5(0x1a0)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x1fd9f6=Buffer[_0x5489d5(0x1a0)](JSON['stringify'](_0x3b8b2d),_0x5489d5(0x16f)),_0x386bcd=Buffer['concat']([_0x599ba1,_0x1fd9f6]);return _0x386bcd[_0x5489d5(0x17d)](_0x1fd9f6['length'],0xe,0x4),await _0x374cfc[_0x5489d5(0x197)](_0x1f401f),_0x374cfc[_0x5489d5(0x17a)]=_0x386bcd,await _0x374cfc[_0x5489d5(0x18e)](null);}async function sticker(_0x11b437,_0x5bdafd,..._0x262c03){const _0xddf337=_0x3aadee;let _0x29c3eb,_0x4071cc;for(let _0x16adad of[sticker3,global[_0xddf337(0x18b)]['ffmpeg']&&sticker6,sticker5,global[_0xddf337(0x18b)][_0xddf337(0x1a5)]&&global[_0xddf337(0x18b)][_0xddf337(0x17c)]&&sticker4,global['support'][_0xddf337(0x1a5)]&&(global['support'][_0xddf337(0x1a9)]||global[_0xddf337(0x18b)][_0xddf337(0x183)]||global[_0xddf337(0x18b)]['gm'])&&sticker2][_0xddf337(0x16b)](_0x17950f=>_0x17950f)){try{_0x4071cc=await _0x16adad(_0x11b437,_0x5bdafd,..._0x262c03);if(_0x4071cc[_0xddf337(0x1a6)](_0xddf337(0x170)))continue;if(_0x4071cc[_0xddf337(0x1a6)](_0xddf337(0x176)))try{return await addExif(_0x4071cc,..._0x262c03);}catch(_0x2dea9f){return console[_0xddf337(0x1b0)](_0x2dea9f),_0x4071cc;}throw _0x4071cc[_0xddf337(0x184)]();}catch(_0x1c6e76){_0x29c3eb=_0x1c6e76;continue;}}return console[_0xddf337(0x1b0)](_0x29c3eb),_0x29c3eb;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};function _0x3439(){const _0x38b70a=['save','inputFormat','join','randomBytes','24508LRMnhY','mime','jpeg','-vcodec','toFormat','load','ext','399126CJKsyz','reply','2927124erdgHM','promises','../tmp','libwebp','.jpeg','from','-vf','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','291244LMfMqc','writeFile','ffmpeg','includes','exports','concat','convert','entries','webp','chat','png:-','https://api.xteam.xyz/sticker/wm?','toBuffer','error','buffer','7YDnQEd','12fUqqZF','filter','application/octet-stream','8968wjyBhk','data','utf8','html','stdout','stdin','close','bin','text','WEBP','3231HZWDbc','exit','addOutputOptions','exif','unlink','ffmpegWebp','writeUIntLE','268098AtRbYD','../tmp/','png','13060GacZCK','status','magick','toString','end','pipe','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','hex','format','5381895QmhKMY','support','readFile','test'];_0x3439=function(){return _0x38b70a;};return _0x3439();}export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};